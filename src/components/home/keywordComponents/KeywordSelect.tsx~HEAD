import styled from "@emotion/styled";
import { useCallback, useState } from "react";
import { category, sectorKey, startup } from "../../../utils/master";
import { Master } from "../InstanseKeyword";
import TitleTabList, { Title } from "./TitleTabList";

type Props = {
  searchNews: (
    keyType: string,
    keyParam: string,
    exchange?: string,
    orderBy?: "top" | "latest" | "popular"
  ) => void;
};

const KeywordSelect = ({ searchNews }: Props) => {
  const [currentTapTitle, setCurrentTabTitle] = useState<Title>("Category");

  const setTitle = useCallback(
    (title: Title) => {
      setCurrentTabTitle(title);
    },
    [setCurrentTabTitle]
  );

  const [filterKeyInSector, setFilterKeyInSector] = useState<string>("A");

  const filterKeysInSector = Object.keys(sectorKey).sort();
  const selectFilterKeyInSector = (key: string) => {
    setFilterKeyInSector(key);
  };

  const fetchNewsApi = (searchObj: Master, keyType: string) => {
    if (!searchObj.exchange) {
      searchNews(keyType, searchObj.paramValue);
    } else {
      searchNews(keyType, searchObj.paramValue, searchObj.exchange);
    }
  };

<<<<<<< HEAD:src/components/home/keywordComponents/KeywordSelect.tsx
=======
  const selectSortKey = (key: string) => {
    setSelectedKey(key);
  };

  const i = sectorKeys.map(item => console.log(item))

  console.log(sectorKeys)
>>>>>>> 0d9e4a6457bd67ea866155e5b19ddfb9c2ea4ed6:src/components/home/KeywordSelect.tsx
  return (
    <KeywordSelectWrap>
      <TitleTabList setTitle={setTitle} tabTitle={currentTapTitle} />
      {currentTapTitle === "Sector" && (
        <KeywordListContainer>
          <CategoryList>
            <ul>
              {filterKeysInSector.map(filterKeyItem => (
                <CategoryListItem
                  key={`Sector-${filterKeyItem}`}
                  onClick={() => selectFilterKeyInSector(filterKeyItem)}
                >
                  <span>{filterKeyItem}</span>
                  <img
                    src="/images/keyword-arrow.svg"
                    alt="섹터 탭 키워드 정렬 화살표"
                  />
                </CategoryListItem>
              ))}
            </ul>
          </CategoryList>

          <KeywordListWrap>
            {sectorKey[filterKeyInSector].map((item: Master, index: number) => (
              <KeywordListItem
                key={`Sector-${item}-${index}`}
                onClick={() => {
                  fetchNewsApi(item, "sectors");
                }}
              >
                {item.name}
              </KeywordListItem>
            ))}
          </KeywordListWrap>
        </KeywordListContainer>
      )}

      {currentTapTitle === "Startup" && (
        <KeywordListContainer>
          <StartupKeywordList>
            <ul>
              {startup.map(item => (
                <li
                  key={`Startup-${item.paramValue}`}
                  onClick={() => {
                    fetchNewsApi(item, "startup");
                  }}
                >
                  {item.name}
                </li>
              ))}
            </ul>
          </StartupKeywordList>
        </KeywordListContainer>
      )}

      {currentTapTitle === "Category" && (
        <KeywordListContainer>
          <StartupKeywordList>
            <ul>
              {category.map(item => (
                <li
                  key={`Category-${item.paramValue}`}
                  onClick={() => {
                    fetchNewsApi(item, "category");
                  }}
                >
                  {item.name}
                </li>
              ))}
            </ul>
          </StartupKeywordList>
        </KeywordListContainer>
      )}
    </KeywordSelectWrap>
  );
};

export default KeywordSelect;

const StartupKeywordList = styled.div`
  overflow-y: scroll;
  ul {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    margin: 10px;
    grid-gap: 0;

    li {
      height: 80px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      cursor: pointer;
    }
    & > li:nth-of-type(12n + 1),
    & > li:nth-of-type(12n + 2),
    & > li:nth-of-type(12n + 3),
    & > li:nth-of-type(12n + 4),
    & > li:nth-of-type(12n + 5),
    & > li:nth-of-type(12n + 6) {
      background-color: #fbfbfb;
    }
    li:hover {
      background: #f0fcfb;
    }
  }
`;

const KeywordSelectWrap = styled.div`
  position: relative;
  z-index: 3;
  margin-top: 14px;
  background: #fff;
  border-radius: 0px 0px 5px 5px;
`;

const KeywordListContainer = styled.div`
  width: 100%;
  height: 450px;
  background: #fff;
  display: flex;
`;

const CategoryList = styled.div`
  width: 324px;
  overflow-y: scroll;
  ul {
    margin-left: 10px;
  }
`;
const CategoryListItem = styled.li`
  height: 55px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0 40px;
  color: #4f4f4f;
  border-bottom: 1px solid #eeeeee;
  cursor: pointer;
  transition: all 0.2s ease;
  img {
    padding-bottom: 3px;
    display: none;
  }
  &:hover {
    background: #f0fcfb;
  }
  &:hover img {
    display: block;
  }
`;

export const KeywordListWrap = styled.div`
  width: 100%;
  padding: 10px;
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  align-content: start;
  overflow-y: scroll;

  & > p:nth-of-type(3n) {
    border: none;
  }

  & > p:nth-of-type(6n + 1),
  & > p:nth-of-type(6n + 2),
  & > p:nth-of-type(6n + 3) {
    background-color: #fbfbfb;
  }
  & > p:hover {
    background: #f0fcfb;
  }
`;

const KeywordListItem = styled.p`
  display: flex;
  height: 37px;
  padding-left: 20px;
  align-items: center;
  font-family: "Noto Sans";
  font-weight: 500;
  font-size: 16px;
  line-height: 30px;
  color: #4f4f4f;
  cursor: pointer;
`;
<<<<<<< HEAD:src/components/home/keywordComponents/KeywordSelect.tsx
=======
function addKeyword(item: string): any {
  throw new Error("Function not implemented.");
}
>>>>>>> 0d9e4a6457bd67ea866155e5b19ddfb9c2ea4ed6:src/components/home/KeywordSelect.tsx
